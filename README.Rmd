---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

```{r include=FALSE}
set.seed(122020)
```

# noah <img src='man/figures/logo.png' align="right" height="139" />

<!-- badges: start -->

[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental) [![CRAN status](https://www.r-pkg.org/badges/version/noah)](https://CRAN.R-project.org/package=noah) [![R build status](https://github.com/Teebusch/noah/workflows/R-CMD-check/badge.svg)](https://github.com/Teebusch/noah/actions) [![Codecov test coverage](https://codecov.io/gh/Teebusch/noah/branch/master/graph/badge.svg)](https://codecov.io/gh/Teebusch/noah?branch=master)

<!-- badges: end -->

noah (*no animals were harmed*) generates pseudonyms that are 
delightful and easy to remember. 
Instead of cryptic alphanumeric IDs, it creates adorable anonymous animals 
like the *Likeable Leech* and the *Proud Chickadee*.

## Installation

You can install noah from [Github](/https://github.com/teebusch/noah) with:

```{r eval=FALSE}
# install.packages("remotes")
remotes::install_github("teebusch/noah")
```

## Usage

### Generating pseudonyms

Use `pseudonymize()` to generate a unique pseudonyms for every unique
element / row in a vectors or data frame. 
`pseudonymize()` accepts any number of vectors and data frames as arguments, 
and will pseudonymize elements row by row. 

```{r}
library(noah)

pseudonymize(1:10)

pseudonymize(rep(c("🐄", "🦎", "🐅"), times = 2))

pseudonymize(c("🐰", "🐰", "🐰"), c("🥕", "🥕", "🍰"))
```

### Adding pseudonyms to data frames

There are two ways to do add pseudonyms to a data frame with noah:
In this example we use the diabetic retinopathy dataset from the `{survival}` 
package.

#### Using `mutate()` and `pseudonymize()`

Here we use `pseudonymize()` and `dplyr::mutate()` to a new column with a 
pseudonym for each unique id:

```{r warning=FALSE, message=FALSE}
library(dplyr)
diabetic <- as_tibble(survival::diabetic)

diabetic %>% 
  mutate(pseudonym = pseudonymize(id)) %>% 
  relocate(pseudonym)
```

#### Using `add_pseudonyms()`

`add_pseudonyms()` wraps mutate relocate. 
It also supports `tidyselect` syntax for the selection of the key columns:

```{r}
diabetic %>% 
  add_pseudonyms(where(is.factor))
```

### Keeping track of pseudonyms

Internally, `pseudonymize()` and `add_pseudonyms()` use an object of class `Ark`
(a pseudonym archive) to keep track of the pseudonyms that have been used.
We can provide an `Ark` to keep track of pseudonyms across multiple function 
calls:

```{r example-ark}
ark <- Ark$new()
ark

# split dataset into left and right eye and pseudonymize separately
diabetic_left <- diabetic %>% 
  filter(eye == "left") %>% 
  add_pseudonyms(id, .ark = ark)

diabetic_right <- diabetic %>% 
  filter(eye == "right") %>% 
  add_pseudonyms(id, .ark = ark)

# reunite the data sets again
bind_rows(diabetic_left, diabetic_right) %>% 
  arrange(id)
```

The ark now contains `r length(ark)` pseudonyms -- as many as there are unique 
id's in the dataset.

```{r}
ark
```

### Making an Alliterating Ark

We can also configure an Ark to generate only alliterations:

```{r}
ark <- Ark$new(alliterate = TRUE)
pseudonymize(1:12, .ark = ark)
```


## Related R packages

There are multiple R packages that generate fake data, including fake names,
phone numbers, addresses, credit card numbers, gene sequences and more:

- [`charlatan`](https://docs.ropensci.org/charlatan/)
- [`randomNames`](https://centerforassessment.github.io/randomNames/)
- [`randNames`](https://github.com/karthik/randNames)
- [`generator`](https://github.com/paulhendricks/generator)
  
There are also packages for anonymizing personal identifiable information in data
sets. 
If you need watertight anonymization you should check out these packages:

- [`sdcMicro`](http://sdctools.github.io/sdcMicro/index.html)
- [`sdcTable`](https://sdctools.github.io/sdcTable/index.html)
- [`anonymizer`](http://paulhendricks.io/anonymizer/)

